
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>4. Variational quantum eigensolver (VQE) &#8212; Introduction to Practical Quantum Computing - University of Nottingham (PHYS4041)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/lectures/lecture4';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="3. Bloch sphere, tomography, and optimisation" href="lecture3.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Introduction to Practical Quantum Computing - University of Nottingham (PHYS4041) - Home"/>
    <img src="../../_static/logo.png" class="logo__image only-dark pst-js-only" alt="Introduction to Practical Quantum Computing - University of Nottingham (PHYS4041) - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Introduction to Practical Quantum Computing - University of Nottingham (PHYS4041)
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Information about the course</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../outline/courseStructure.html">Course Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../outline/pythonEnvironment.html">Setup Python and Pennylane</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lectures</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lecture1.html">1. Quantum mechanics of a qubit</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture2.html">2. Multiple qubits, entanglement, and IBMQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture3.html">3. Bloch sphere, tomography, and optimisation</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">4. Variational quantum eigensolver (VQE)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/content/lectures/lecture4.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Variational quantum eigensolver (VQE)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-time-independent-schrodinger-equation">4.1. The time-independent Schrödinger equation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-the-ground-state">4.2. Finding the ground state</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quantum-state-ansatz">4.3. Quantum state ansatz</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#measuring-the-energy">4.4. Measuring the energy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">4.5. References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="variational-quantum-eigensolver-vqe">
<span id="sec-vqe"></span><h1><span class="section-number">4. </span>Variational quantum eigensolver (VQE)<a class="headerlink" href="#variational-quantum-eigensolver-vqe" title="Link to this heading">#</a></h1>
<p>One of the most prominent and practical algorithms for a quantum computer is inspired by Feynman’s original vision. The algorithm (or set of algorithm’s) is called the variational quantum eigensolver (VQE). This is an example of a quantum-classical hybrid optimisation algorithm. The basic idea is to have an ansatz or guess on the quantum computer which has parameters that we can optimise. The measurement outcomes are fed into a classical algorithm which then proposes the next update for the quantum computer. In this case the goal is to find the lowest eigenvalue of an operator of interest, which corresponds to the ground state energy of a physical problem.</p>
<section id="the-time-independent-schrodinger-equation">
<h2><span class="section-number">4.1. </span>The time-independent Schrödinger equation<a class="headerlink" href="#the-time-independent-schrodinger-equation" title="Link to this heading">#</a></h2>
<p>Many problems in quantum many-body physics can be boiled down the solving the Schrödinger equation. Here we will be interested in the <em>time-independent</em> Schrödinger equation</p>
<div class="math notranslate nohighlight" id="equation-eq-schrodinger-equation">
<span class="eqno">(4.1)<a class="headerlink" href="#equation-eq-schrodinger-equation" title="Link to this equation">#</a></span>\[
    \hat{H} |\psi\rangle = E |\psi\rangle,
\]</div>
<p>which is an eigenproblem.
The Hamiltonian operator <span class="math notranslate nohighlight">\(\hat{H}\)</span> is a Hermitian operator (<span class="math notranslate nohighlight">\(H^\dagger\)</span> = <span class="math notranslate nohighlight">\(H\)</span>) that plays the role of energy in quantum mechanical systems. The eigenvalue <span class="math notranslate nohighlight">\(E\)</span> is the energy of a particular eigenstate that solves this equation. This is generically a hard problem! A typical approach is to approximate the Hamiltonian by a finite but large matrix, the size of which generically grows exponentially with the number of particles involved. This is the same problem we have already encountered with the size of the vector space for our qubits.</p>
<p>As an example, many magnetic materials can be approximated by lattices of spin-1/2 degrees of freedom, which are two level systems similar to our qubits. If we map this lattice of spins to our qubits then we can see that the size of the matrices grows exponentially with the number of sites in the lattice. The current limit for generic systems on the most powerful supercomputers is around 50 qubits / spins. It is clear that this is far from a realistic model of real materials. It is worth noting that in many cases we can do far better than this by taking advantage of symmetries, low dimensionality, semi-classical models etc. However, these approach are ineffective for many physically relevant models and here quantum computers may be able to help.</p>
<p>The VQE algorithm was first demonstrated in the context of quantum chemistry by finding the ground state of simple molecules <span id="id1">[<a class="reference internal" href="#id5" title="Alberto Peruzzo, Jarrod McClean, Peter Shadbolt, Man-Hong Yung, Xiao-Qi Zhou, Peter J. Love, Alán Aspuru-Guzik, and Jeremy L. O'Brien. A variational eigenvalue solver on a photonic quantum processor. Nature Communications, 5(1):4213, sep 2014. URL: http://www.nature.com/articles/ncomms5213, doi:10.1038/ncomms5213.">PMS+14</a>]</span><span id="id2">[<a class="reference internal" href="#id4" title="Abhinav Kandala, Antonio Mezzacapo, Kristan Temme, Maika Takita, Markus Brink, Jerry M. Chow, and Jay M. Gambetta. Hardware-efficient variational quantum eigensolver for small molecules and quantum magnets. Nature, 549(7671):242–246, sep 2017. doi:10.1038/nature23879.">KMT+17</a>]</span>. This is the case we will also focus on.</p>
</section>
<section id="finding-the-ground-state">
<h2><span class="section-number">4.2. </span>Finding the ground state<a class="headerlink" href="#finding-the-ground-state" title="Link to this heading">#</a></h2>
<p>The task that we will consider is to find the ground state of the Schr{“o}dinger equation. That is to find the state <span class="math notranslate nohighlight">\(|\psi\rangle\)</span> that solves the Schr{“o}dinger equation~\eqref{eq: Schrodinger equation} with the lowest energy <span class="math notranslate nohighlight">\(E\)</span>. Formally, the goal is to find the state <span class="math notranslate nohighlight">\(|\psi\rangle\)</span> that minimises</p>
<div class="math notranslate nohighlight">
\[
E = \min_{|\psi\rangle} \frac{\langle \psi | \hat{H} |\psi\rangle}{\langle \psi | \psi \rangle} = \min_{|\psi\rangle}\langle \psi | \hat{H} |\psi\rangle,
\]</div>
<p>where in the second equality we used the fact that the state <span class="math notranslate nohighlight">\(|\psi\rangle\)</span> is normalised. On the quantum computer we always start with the zero state <span class="math notranslate nohighlight">\(|000\cdots \rangle\)</span>, and so we rephrase the problem as finding the quantum circuit <span class="math notranslate nohighlight">\(V\)</span> such that <span class="math notranslate nohighlight">\(|\psi\rangle = V |000\cdots\rangle\)</span>, i.e.,</p>
<figure class="align-center" id="fig-vqe-general-circuit">
<a class="reference internal image-reference" href="../../_images/VQEGeneralCircuit.png"><img alt="../../_images/VQEGeneralCircuit.png" src="../../_images/VQEGeneralCircuit.png" style="width: 30%;" /></a>
</figure>
<p>minimises the energy.</p>
<p>The quantum circuit in <code class="xref std std-numref docutils literal notranslate"><span class="pre">fig:VQE_general_circuit</span></code> contains a large multiple qubit gate. As we mentioned in a previous section, we are able to approximate a general multi-qubit gate using only the single qubit rotations and the CNOT gate. The art of VQE is to come up with the best quantum circuit to approximate <span class="math notranslate nohighlight">\(V\)</span>.</p>
<p>The basic setup of VQE consists of the following three steps:</p>
<ol class="arabic simple">
<li><p>Create an ansatz quantum circuit with variable parameters that can be optimised.</p></li>
<li><p>Measure the quantum circuit to extract the value of the energy.</p></li>
<li><p>Use a classical optimisation algorithm to propose updated parameters for the quantum circuit ansatz, then repeat from 1.</p></li>
</ol>
<p>We will discuss these three steps in greater detail in the following three sections.</p>
</section>
<section id="quantum-state-ansatz">
<h2><span class="section-number">4.3. </span>Quantum state ansatz<a class="headerlink" href="#quantum-state-ansatz" title="Link to this heading">#</a></h2>
<p>The first step in the VQE algorithm is choose an ansatz quantum circuit which will approximate our ground state <span class="math notranslate nohighlight">\(|\psi\rangle\)</span>. This is part of the art of VQE, designing a circuit structure that can well approximate our target state. On the simplest level, we want to have enough parameters and generate enough entanglement to represent the state while using gates that are easy for us to implement, such as rotations and CNOT gates.</p>
<figure class="align-center" id="fig-vqe-parameterized-circuit">
<a class="reference internal image-reference" href="../../_images/VQEParameterizedCircuit.png"><img alt="../../_images/VQEParameterizedCircuit.png" src="../../_images/VQEParameterizedCircuit.png" style="width: 40%;" /></a>
</figure>
<p>where the <span class="math notranslate nohighlight">\(U = U(\alpha, \beta, \gamma, \delta)\)</span> gates are general single rotations of the form in Eq.<a class="reference internal" href="lecture1.html#equation-eq-general-rotation">(1.1)</a>, with different angles for each gate. The Block indicated by the dashed box can be repeated <span class="math notranslate nohighlight">\(d\)</span> times to create an ansatz with more parameters and angles.</p>
</section>
<section id="measuring-the-energy">
<h2><span class="section-number">4.4. </span>Measuring the energy<a class="headerlink" href="#measuring-the-energy" title="Link to this heading">#</a></h2>
<p>The next step is to measure the energy. This is the function that we are minimising in our optimisation procedure. The energy is the expectation value of the Hamiltonian operator with respect to our ansatz state, that is,</p>
<div class="math notranslate nohighlight">
\[
    E(\vec{\theta}) = \langle H \rangle_{\vec{\theta}} = \langle \psi | H |\psi\rangle,
\]</div>
<p>where <span class="math notranslate nohighlight">\(|\psi\rangle\)</span> is our ansatz quantum state which implicitly depends on the set of angles <span class="math notranslate nohighlight">\(\vec{\theta}\)</span>.</p>
<p>The general form of a multi-qubit Hamiltonian is the following</p>
<div class="math notranslate nohighlight">
\[
    H = \sum_{A=1,X,Y,Z} \sum_i h_i^A A_i + \sum_{A,B=X,Y,Z}\sum_{ij} h_{ij}^{AB} A_i B_j + \cdots,
\]</div>
<p>where the remaining terms contain higher order Pauli strings (products of non-trivial Pauli-operators). In practice we will often only be interested in Hamiltonians with a limited number of non-zero terms. The energy is then given by</p>
<div class="math notranslate nohighlight">
\[
    \langle H \rangle = \sum_{A=1,X,Y,Z} \sum_i h_i^A \langle A_i \rangle + \sum_{A,B=X,Y,Z}\sum_{ij} h_{ij}^{AB} \langle A_i B_j \rangle + \cdots,
\]</div>
<p>where the angled brackets correspond to expectation values with respect to the ansatz state, i.e., <span class="math notranslate nohighlight">\(\langle \cdot \rangle = \langle \psi | \cdot |\psi \rangle\)</span>. Given the Hamiltonian parameters <span class="math notranslate nohighlight">\(\{h_i^A, h_{ij}^{AB},\cdots\}\)</span>, our goal is then to measure expectation values for the required Pauli strings.</p>
<p>Let us consider a couple of simple examples which will make it clear how to measure general Pauli strings. For concreteness, suppose we have four qubits and we want to measure <span class="math notranslate nohighlight">\(\langle Z_2 Z_3 \rangle\)</span>. Since the Pauli-Z is already diagonal in the computational basis, the corresponding circuit is</p>
<figure class="align-center" id="fig-z-basis-measurement">
<a class="reference internal image-reference" href="../../_images/ZBasisMeasurement.png"><img alt="../../_images/ZBasisMeasurement.png" src="../../_images/ZBasisMeasurement.png" style="width: 35%;" /></a>
</figure>
<p>where we only measure the second and third qubits. Note that in practice we can measure all qubits and reproduce probabilities as explained in Eq.<a class="reference internal" href="lecture2.html#equation-eq-reduced-measurement">(2.1)</a>, and so can construct several expectation values from a single set of measurements. From these measurements we can estimate the probabilities for each of the four basis states for qubits 2 and 3. The expectation value is then given by</p>
<div class="math notranslate nohighlight">
\[
    \langle Z_2 Z_3 \rangle = p(|00\rangle) + p(|11\rangle) - p(|01\rangle) - p(|10\rangle),
\]</div>
<p>where the signs are given by the eigenvalues of <span class="math notranslate nohighlight">\(Z_2 Z_3\)</span> for the given basis state, e.g., <span class="math notranslate nohighlight">\(Z_2 Z_3 |00\rangle = |00\rangle\)</span>, but <span class="math notranslate nohighlight">\(Z_2 Z_3 |01\rangle = -|01\rangle\)</span>.</p>
<p>As a second example, consider measuring <span class="math notranslate nohighlight">\(\langle X_2 Y_3 \rangle\)</span>. In this case the operator is not diagonal in the computational basis and so we must first make a change of basis. The corresponding circuit would be</p>
<figure class="align-center" id="fig-second-pauli-example">
<a class="reference internal image-reference" href="../../_images/SecondPauliExample.png"><img alt="../../_images/SecondPauliExample.png" src="../../_images/SecondPauliExample.png" style="width: 55%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4.1 </span><span class="caption-text">Basis transformation for measuring the expectation value <span class="math notranslate nohighlight">\(\langle X_2 Y_3 \rangle\)</span>.</span><a class="headerlink" href="#fig-second-pauli-example" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>where the <span class="math notranslate nohighlight">\(H\)</span> and <span class="math notranslate nohighlight">\(S\)</span> change basis. With the extra basis change we are effectively measuring <span class="math notranslate nohighlight">\(\langle Z_2 Z_3 \rangle\)</span> again but now for a different circuit including the basis change. That is, the expectation value is given by</p>
<div class="math notranslate nohighlight">
\[
    \langle X_2 Y_3 \rangle = p(|00\rangle) + p(|11\rangle) - p(|01\rangle) - p(|10\rangle),
\]</div>
<p>where the probabilities are given by circuit in Eq.<a class="reference internal" href="#fig-second-pauli-example"><span class="std std-numref">Fig. 4.1</span></a>.</p>
</section>
<hr class="docutils" />
<section id="references">
<h2><span class="section-number">4.5. </span>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<div class="docutils container" id="id3">
<div role="list" class="citation-list">
<div class="citation" id="id4" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">KMT+17</a><span class="fn-bracket">]</span></span>
<p>Abhinav Kandala, Antonio Mezzacapo, Kristan Temme, Maika Takita, Markus Brink, Jerry M. Chow, and Jay M. Gambetta. Hardware-efficient variational quantum eigensolver for small molecules and quantum magnets. <em>Nature</em>, 549(7671):242–246, sep 2017. <a class="reference external" href="https://doi.org/10.1038/nature23879">doi:10.1038/nature23879</a>.</p>
</div>
<div class="citation" id="id5" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">PMS+14</a><span class="fn-bracket">]</span></span>
<p>Alberto Peruzzo, Jarrod McClean, Peter Shadbolt, Man-Hong Yung, Xiao-Qi Zhou, Peter J. Love, Alán Aspuru-Guzik, and Jeremy L. O'Brien. A variational eigenvalue solver on a photonic quantum processor. <em>Nature Communications</em>, 5(1):4213, sep 2014. URL: <a class="reference external" href="http://www.nature.com/articles/ncomms5213">http://www.nature.com/articles/ncomms5213</a>, <a class="reference external" href="https://doi.org/10.1038/ncomms5213">doi:10.1038/ncomms5213</a>.</p>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content/lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="lecture3.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">3. </span>Bloch sphere, tomography, and optimisation</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-time-independent-schrodinger-equation">4.1. The time-independent Schrödinger equation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-the-ground-state">4.2. Finding the ground state</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quantum-state-ansatz">4.3. Quantum state ansatz</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#measuring-the-energy">4.4. Measuring the energy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">4.5. References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dr Adam Gammon-Smith
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>